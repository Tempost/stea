generator client {
    provider        = "prisma-client-js"
    previewFeatures = ["referentialIntegrity"]
}

datasource db {
    provider             = "mysql"
    url                  = env("DATABASE_URL")
    referentialIntegrity = "prisma"
}

generator zod {
    provider              = "zod-prisma"
    output                = "./zod"
    relationModel         = true
    modelCase             = "PascalCase"
    modelSuffix           = "Model"
    useDecimalJs          = true
    imports               = null
    prismaJsonNullability = true
}

model Member {
    uid            String         @id @default(cuid())
    createdAt      DateTime?      @default(now())
    updatedAt      DateTime?      @updatedAt
    firstName      String         @db.VarChar(255)
    lastName       String         @db.VarChar(255)
    fullName       String         @db.VarChar(255)
    memberType     String         @db.VarChar(50)
    memberStatus   String         @db.VarChar(20)
    family         FamilyMember[]
    horses         Horse[]
    ranking        TotalRanking?  @relation(fields: [rankingId], references: [uid])
    rankingId      String?        @unique
    shows          Show[]
    boardMember    Boolean        @default(false)
    address        String         @db.VarChar(255)
    city           String         @db.VarChar(25)
    state          String         @db.VarChar(25)
    zip            Int
    phone          String         @db.VarChar(15)
    email          String?        @db.VarChar(100)
    previousMember Boolean        @default(false)
    riderLevel     String         @db.VarChar(25)
    confirmed      Boolean        @default(false)
    RiderCombo     RiderCombo[]
}

model corporateMember {
    name      String    @db.VarChar(255)
    createdAt DateTime? @default(now())
    updatedAt DateTime? @updatedAt
    address   String    @db.VarChar(255)
    city      String    @db.VarChar(25)
    state     String    @db.VarChar(25)
    zip       Int
    phone     String    @db.VarChar(15)
    email     String?   @db.VarChar(100)
    contact   String    @db.VarChar(255)
    regType   String    @db.VarChar(255)
    horses    Horse[]

    @@id([name])
}

model FamilyMember {
    uid        String    @id @default(cuid())
    createdAt  DateTime? @default(now())
    updatedAt  DateTime? @updatedAt
    name       String    @db.VarChar(255)
    email      String?   @db.VarChar(100)
    riderLevel String    @db.VarChar(25)
    member     Member    @relation(fields: [memberId], references: [uid], onUpdate: NoAction)
    memberId   String

    @@index(memberId)
}

model Horse {
    uid              String           @id @default(cuid())
    createdAt        DateTime?        @default(now())
    updatedAt        DateTime?        @updatedAt
    horseRN          String           @db.VarChar(255)
    horseAKA         String?          @db.VarChar(255)
    registrationDate DateTime?
    regType          String           @db.VarChar(25)
    member           Member?          @relation(fields: [memberId], references: [uid])
    memberId         String?
    corporateMember  corporateMember? @relation(fields: [corpId], references: [name])
    corpId           String?
    ranking          TotalRanking?    @relation(fields: [rankingId], references: [uid])
    rankingId        String?          @unique

    RiderCombo RiderCombo[]
    @@index(memberId)
}

model RiderCombo {
    uid       String    @id @default(cuid())
    createdAt DateTime? @default(now())
    updatedAt DateTime? @updatedAt
    rider     Member    @relation(fields: [riderId], references: [uid])
    riderId   String
    horse     Horse     @relation(fields: [horseId], references: [uid])
    horseId   String

    @@index([riderId, horseId])
}

model TotalRanking {
    uid         String    @id @default(cuid())
    createdAt   DateTime? @default(now())
    updatedAt   DateTime? @updatedAt
    level       String    @db.VarChar(3)
    division    String    @db.VarChar(20)
    rider       Member?
    horse       Horse?
    totalPoints Float
    totalShows  Int
    completedHT Boolean
}

model Show {
    uid       String    @id @default(cuid())
    createdAt DateTime? @default(now())
    updatedAt DateTime? @updatedAt
    showName  String    @db.VarChar(150)
    showType  String    @db.VarChar(10)
    riders    Member[]
}
